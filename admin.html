<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SmpTier — Admin</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<header class="header container">
  <img src="assets/logo.png" alt="logo" class="logo">
  <div>
    <div class="brand">SmpTier</div>
    <div class="lead">Administration</div>
  </div>
  <nav>
    <a href="index.html">Accueil</a>
    <a href="criteres.html">Critères</a>
    <a href="classement.html">Classement</a>
    <a href="file-test.html">Tester mon SMP</a>
    <a href="admin.html">Admin</a>
  </nav>
</header>

<main class="container">
  <section class="section card">
    <h2>Admin</h2>
    <input type="password" id="adminPass" placeholder="Mot de passe admin">
    <button class="btn btn-primary" id="loginBtn">Se connecter</button>
    <div id="adminPanel" style="display:none; margin-top:20px;">
      <h3>Ajouter un SMP</h3>
      <form id="addSmpForm">
        <input type="text" placeholder="Nom du SMP" required><br><br>
        <input type="text" placeholder="Discord" required><br><br>
        <input type="text" placeholder="IP" required><br><br>
        <input type="text" placeholder="Twist" required><br><br>
        <input type="date" placeholder="Date de création" required><br><br>
        <input type="number" placeholder="Tier (1-5)" required min="1" max="5"><br><br>
        <button class="btn btn-primary" type="submit">Ajouter</button>
      </form>
    </div>
  </section>
</main>

<footer class="footer">© 2025 SmpTier</footer>

<script type="module">
import { db } from './firebase-init.js';
import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const password = "TonMotDePasseAdmin123"; // change le mot de passe ici
const loginBtn = document.getElementById('loginBtn');
const adminPanel = document.getElementById('adminPanel');

loginBtn.addEventListener('click', ()=>{
  const pass = document.getElementById('adminPass').value;
  if(pass === password){ adminPanel.style.display = 'block'; }
  else{ alert('Mot de passe incorrect'); }
});

const form = document.getElementById('addSmpForm');
form.addEventListener('submit', async e=>{
  e.preventDefault();
  const inputs = form.querySelectorAll('input');
  try{
    await addDoc(collection(db,'smp_public'),{
      name: inputs[0].value,
      discord: inputs[1].value,
      ip: inputs[2].value,
      twist: inputs[3].value,
      date: inputs[4].value,
      tier: parseInt(inputs[5].value)
    });
    alert('SMP ajouté au classement !');
    form.reset();
  }catch(err){ console.error(err); alert('Erreur lors de l\'ajout'); }
});
</script>
</body>
</html>

